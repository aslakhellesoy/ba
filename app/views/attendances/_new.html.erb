<% form_for(:attendance, :url => attendances_path(:url => url)) do |f| %>
  <% if !current_site_user %>
    <% fields_for(:site_user) do |u| %>
      <%= render :partial => 'site_users/form', :locals => {:form => u} %>
    <% end %>
  <% end %>

  <p><%= f.label :price_code, 'Price Code' %>
  <%= f.text_field :price_code %></p>

  <p><%= check_box_tag 'presenting', '1', params[:presenting] %>
  <label for="presenting">I want to present</label></p>
  <%= observe_field :presenting, :function => '$("presentation_fields").toggle();' %>

  <div id="presentation_fields" style="display: <%= params[:presenting] ? 'block' : 'none' %>">
    <% fields_for(:presentation) do |p| %>
      <%= render :partial => 'presentations/form', :locals => {:form => p} %>
    <% end %>
  </div>

  <%= f.submit("Sign up") %>
<% end %>
